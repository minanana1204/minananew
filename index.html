<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¥³å‹ç”Ÿæ°£äº†è¦æ€éº¼è¾¦ğŸ¥µ</title>
    <style>
        body {
            color: white;
            font-family: 'Courier New', Courier, monospace;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background: #000;
        }

        #backgroundWrapper {
            width: 80vw;
            max-width: 800px;
            height: 80vw;
            max-height: 800px;
            display: flex;
            justify-content: center;
            align-items: flex-end;
            background-size: cover;
            background-repeat: no-repeat;
            background-position: center bottom;
        }

        #gameContainer {
            width: 100%;
            height: 200px;
            background: rgba(0, 0, 0, 0.8);
            padding: 10px;
            display: none;
            box-sizing: border-box;
            border: 1px solid #fff;
            overflow: hidden;
        }

        #messages {
            height: 80%;
            overflow-y: auto;
            margin-bottom: 10px;
        }

        .message {
            margin: 5px 0;
        }

        .userMessage {
            color: #0f0;
        }

        .botMessage {
            color: #ff0;
        }

        #messageInput {
            width: 100%;
            padding: 10px;
            box-sizing: border-box;
            background: transparent;
            border: none;
            border-top: 1px solid #fff;
            color: white;
            font-size: 16px;
        }

        #startButton,
        #introButton,
        #quickButton,
        #restartButton {
            padding: 15px 30px;
            font-size: 20px;
            cursor: pointer;
            margin-bottom: 20px;
            color: white;
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid #fff;
            border-radius: 5px;
            box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
        }

        #startButton:hover,
        #introButton:hover,
        #quickButton:hover,
        #restartButton:hover {
            background: rgba(0, 0, 0, 1);
            box-shadow: 0px 6px 15px rgba(0, 0, 0, 0.5);
            transform: scale(1.05);
        }

        #introBlock,
        #inputBlock {
            width: 80%;
            max-width: 600px;
            background: rgba(0, 0, 0, 0.8);
            padding: 20px;
            box-sizing: border-box;
            border: 1px solid #fff;
            margin-bottom: 20px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            display: none;
        }

        #userInfoForm input {
            width: 80%;
            padding: 10px;
            box-sizing: border-box;
            background: transparent;
            border: none;
            border-bottom: 1px solid #fff;
            color: white;
            font-size: 16px;
            margin: 10px 0;
        }

        #submitButton {
            padding: 15px 30px;
            font-size: 20px;
            cursor: pointer;
            margin-top: 20px;
            color: white;
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid #fff;
            border-radius: 5px;
            box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
        }

        #submitButton:hover {
            background: rgba(0, 0, 0, 1);
            box-shadow: 0px 6px 15px rgba(0, 0, 0, 0.5);
            transform: scale(1.05);
        }
    </style>
</head>

<body>
    <div id="introBlock">
        <h2>æ­¡è¿ä¾†åˆ°ã€Šå¥³å‹ç”Ÿæ°£äº†è¦æ€éº¼è¾¦ğŸ¥µã€‹</h2>
        <p>ã€Šå¥³å‹ç”Ÿæ°£äº†è¦æ€éº¼è¾¦ã€‹é€™æ˜¯ä¸€æ¬¾æŒ‘æˆ°ç©å®¶å‰µæ„çš„å°è©±å¼å†’éšªéŠæˆ²ã€‚ä½ å°‡æ‰®æ¼”ä¸»è§’é¨é¨ï¼Œä¾†å“„å¥³å‹å¨œå¨œé–‹å¿ƒã€‚é€™å€‹éŠæˆ²å……æ»¿äº†æŒ‘æˆ°å’Œé™·é˜±ï¼Œè«‹æ³¨æ„æœ€å¥½ç”¨é€šéˆçš„æ–¹å¼ä¾†çŒœå¨œå¨œçš„å¿ƒæƒ…ã„›â¤ï¸ã€‚</p>
        <button id="startButton">é–‹å§‹éŠæˆ²</button>
    </div>

    <div id="inputBlock">
        <h2>è¼¸å…¥ä½ çš„ä¿¡æ¯</h2>
        <form id="userInfoForm">
            <label for="playerName">åå­—ï¼š</label>
            <input type="text" id="playerName" placeholder="è¼¸å…¥ä½ çš„åå­—" required><br><br>
            <label for="apiKey">API Keyï¼š</label>
            <input type="text" id="apiKey" placeholder="è¼¸å…¥ä½ çš„ API Key" required><br><br>
            <button type="submit" id="submitButton">ç¢ºèªä¸¦é–‹å§‹éŠæˆ²</button>
        </form>
    </div>

    <div id="backgroundWrapper" style="background-image: url('./img/scene0.jpg');">
        <button id="introButton">éŠæˆ²ä»‹ç´¹</button>
        <button id="restartButton" style="display: none;">é‡æ–°é–‹å§‹éŠæˆ²</button>
        <button id="quickButton" style="display: none;">å®Œæ•´é¡¯ç¤ºå°è©±</button>
        <div id="gameContainer">
            <div id="messages"></div>
            <form id="messageForm">
                <input type="text" id="messageInput" placeholder="è¼¸å…¥ä½ çš„é¸é …...">
            </form>
        </div>
    </div>

    <script>
        var conversationHistory = [];
        var currentScene = 0;
        var quickDisplay = false;
        var playerName = '';
        var apiKey = '';

        var scenes = [
            {
                "scene": "ä¸­å¤®å¥³ä¸€åˆ°å››å®¿èˆé–€å£",
                "text": `ä½ ç«™åœ¨ä¸­å¤®å¥³ä¸€åˆ°å››å®¿èˆé–€å£ï¼Œå¨œå¨œç”Ÿæ°£åœ°çœ‹è‘—ä½ ï¼Œã€Œã„Œã„©ã„ä½ åˆ°åº•æƒ³è¦å¹¹å˜›å•¦ï¼Ÿã€ä½ æ„Ÿåˆ°ä¸€é™£ç·Šå¼µï¼Œæ€è€ƒè‘—å¦‚ä½•åŒ–è§£å¥¹çš„æ€’ç«ã€‚
                <br><br><strong>é¸æ“‡ï¼š</strong>
                <br>A. èªçœŸé“æ­‰ã€‚
                <br>B. é–‹ç©ç¬‘èªªï¼šã€Œä»Šæ™šçš„æœˆè‰²çœŸç¾å•Šã€‚ğŸŒã€
                <br>C. æè­°å»åƒå¥¹æœ€å–œæ­¡çš„ç”œé»ã€‚`,
                "options": {
                    "A": 1,
                    "B": 2,
                    "C": 3
                },
                "image": "./img/scene1.jpg"
            },
            {
                "scene": "é“æ­‰å¤±æ•—",
                "text": `ä½ èªçœŸé“æ­‰ï¼Œä½†å¨œå¨œä¸ç‚ºæ‰€å‹•ï¼Œã€Œé“æ­‰æœ‰ä»€éº¼ç”¨ï¼Œé€™æ ¹æœ¬æ˜¯æŠ„è„†çš„é“æ­‰SOPï¼Œä½ æ ¹æœ¬å°±ä¸æ˜ç™½æˆ‘ç”Ÿæ°£çš„åŸå› ï¼ã€ 
                <br><strong>çµå±€ï¼š</strong>ä½ çš„é“æ­‰è®“å¨œå¨œæ›´åŠ ç”Ÿæ°£ï¼Œå¥¹æ±ºå®šæŠŠè‡ªå·±å†°åˆ°å®¿èˆå†°ç®±å†·éœã€‚`,
                "options": {},
                "image": "./img/scene2.jpg"
            },
            {
                "scene": "é–‹ç©ç¬‘å¤±æ•—",
                "text": `ä½ è©¦åœ–é–‹å€‹ç©ç¬‘ï¼Œèªªï¼šã€Œä»Šæ™šçš„æœˆè‰²çœŸç¾å•Šã€‚ã€å¨œå¨œå†·å†·åœ°çœ‹è‘—ä½ ï¼Œã€Œé€™æ™‚å€™ä½ é‚„åœ¨é–‹ç©ç¬‘ï¼Ÿã€ 
                <br><strong>é¸æ“‡ï¼š</strong>
                <br>A. èªçœŸé“æ­‰ã€‚
                <br>B. èªªèªªä½ å”±æ“±æ·ºçµ¦å¥¹è½ã€‚
                <br>C. æè­°å»åƒå¥¹æœ€å–œæ­¡çš„ç”œé»ã€‚`,
                "options": {
                    "A": 1,
                    "B": 4,
                    "C": 3
                },
                "image": "./img/scene3.jpg"
            },
            {
                "scene": "ç”œé»æè­°",
                "text": `ä½ æè­°å»åƒå¥¹æœ€å–œæ­¡çš„ç”œé»ï¼Œã€Œæˆ‘å€‘å»åƒä½ æœ€å–œæ­¡çš„ç”œé»å§ï¼Ÿã€å¨œå¨œçœ‹èµ·ä¾†æœ‰é»å‹•å¿ƒï¼Œä½†ä»èˆŠå†·æ¼ åœ°å›ç­”ï¼Œã€Œä½ ä»¥ç‚ºç”œé»èƒ½è§£æ±ºæ‰€æœ‰å•é¡Œå—ï¼Ÿã€
                <br><strong>é¸æ“‡ï¼š</strong>
                <br>A. èªªç”œé»ç¸½æ˜¯èƒ½è®“äººå¿ƒæƒ…å¥½ä¸€é»ã€‚
                <br>B. èªªä½ åªæƒ³è®“å¥¹é–‹å¿ƒã€‚
                <br>C. æè­°ä¸€èµ·å»æ•£æ­¥ã€‚`,
                "options": {
                    "A": 5,
                    "B": 6,
                    "C": 7
                },
                "image": "./img/scene4.jpg"
            },
            {
                "scene": "å”±æ“±æ·ºå¤±æ•—",
                "text": `ä½ è©¦åœ–å”±æ“±æ·ºçµ¦å¥¹è½ï¼Œã€Œæˆ‘åªèƒ½æ°¸é è®€è‘—å°ç™½....ç ´éŸ³äº†ã€å¨œå¨œå¤§ç¬‘ï¼Œä½†å¾Œä¾†åˆèªªã€Œä½ æ ¹æœ¬ä¸ç†è§£æˆ‘ï¼ã€ 
                <br><strong>çµå±€ï¼š</strong>å› ç‚ºä½ ä¹‹å‰èªªå¨œå¨œæ˜¯éŸ³ç™¡ï¼Œä½ çš„æ­Œè²è®“å¨œå¨œæ›´åŠ ç”Ÿæ°£ï¼Œå¥¹æ±ºå®šå»å€’åƒåœ¾ä¸ç†ä½ ã€‚`,
                "options": {},
                "image": "./img/scene5.jpg"
            },
            {
                "scene": "ç”œé»å¤±æ•—",
                "text": `ä½ èªªç”œé»ç¸½æ˜¯èƒ½è®“äººå¿ƒæƒ…å¥½ä¸€é»ï¼Œä½†å¨œå¨œä¸è²·å¸³ï¼Œã€Œæˆ‘ç”Ÿæ°£ä¸æ˜¯å› ç‚ºç”œé»ä¸å¤ åƒï¼ã€ 
                <br><strong>çµå±€ï¼š</strong>ä½ çš„æè­°æœªèƒ½è®“å¨œå¨œæ”¹è®Šå¿ƒæƒ…ï¼Œå¥¹æ±ºå®šå»åƒä¸Šè¼è®“å¿ƒæƒ…å¥½ä¸€é»ã€‚`,
                "options": {},
                "image": "./img/scene6.jpg"
            },
            {
                "scene": "æ„Ÿå‹•å¤±æ•—",
                "text": `ä½ èªªä½ åªæƒ³è®“å¥¹é–‹å¿ƒï¼Œä½†å¨œå¨œåªæ˜¯å†·ç¬‘ï¼Œã€Œä½ ç¾åœ¨æ‰æƒ³åˆ°è¦è®“æˆ‘é–‹å¿ƒï¼Ÿã€ 
                <br><strong>çµå±€ï¼š</strong>ä½ çš„è§£é‡‹æ²’æœ‰æ‰“å‹•å¨œå¨œï¼Œå¨œå¨œæ°£åˆ°è®Šæˆç‰ç±³è»è‰¦ï¼Œä¸¦ä¸”ä¸€ç›´å•ä½ è¦ä¸è¦åƒå¥¹ã€Œè¦ä¸è¦åƒã€ã€Œè¦ä¸è¦åƒã€ã€‚`,
                "options": {},
                "image": "./img/scene7.jpg"
            },
            {
                "scene": "æ•£æ­¥æè­°",
                "text": `ä½ æè­°ä¸€èµ·å»æ•£æ­¥ï¼Œã€Œæˆ‘å€‘å¯ä»¥å»èµ°èµ°ï¼Œé€™æ¨£ä¹Ÿè¨±èƒ½è®“ä½ å¿ƒæƒ…å¥½ä¸€é»ã€‚ã€å¨œå¨œçš„çœ¼ç¥ç¨å¾®ç·©å’Œäº†ä¸€äº›ï¼Œã€Œå¥½å§ï¼Œä½†ä½ è¦é¸å€‹é©åˆçš„æ™‚é–“ã€‚ã€
                <br><strong>é¸æ“‡ï¼š</strong>
                <br>A. æ˜ŸæœŸä¸‰æ™šä¸Š8é»ã€‚
                <br>B. æ˜ŸæœŸå››æ™šä¸Š6é»ã€‚
                <br>C. å‚³è¨Šæ¯å•å¨œå¨œã€Œè¦ç¾åœ¨å—ã€ã€‚`,
                "options": {
                    "A": 8,
                    "B": 9,
                    "C": 10
                },
                "image": "./img/scene8.jpg"
            },
            {
                "scene": "æ˜ŸæœŸä¸‰æ™šä¸Š8é»å¤±æ•—",
                "text": `ä½ æè­°æ˜ŸæœŸä¸‰æ™šä¸Š8é»æ•£æ­¥ï¼Œå¨œå¨œçœ‹èµ·ä¾†å¾ˆçŒ¶è±«ï¼Œã€Œæˆ‘é‚£æ™‚å€™å·²ç¶“å’Œç¤¾æœƒå­¸ç´„å¥½äº†ã€‚ã€ 
                <br><strong>çµå±€ï¼š</strong>å¨œå¨œæœ€çµ‚é¸æ“‡äº†å’Œç¤¾æœƒå­¸è€å¸«ç´„æœƒï¼Œä½ éŒ¯å¤±äº†å’Œå¥¹æ•£æ­¥çš„æ©Ÿæœƒï¼Œå¥¹æ±ºå®šä¹‹å¾Œéƒ½å’Œè€å¸«åœ¨ä¸€èµ·ã€‚`,
                "options": {},
                "image": "./img/scene9.jpg"
            },
            {
                "scene": "æ˜ŸæœŸå››æ™šä¸Š6é»å¤±æ•—",
                "text": `ä½ æè­°æ˜ŸæœŸå››æ™šä¸Š6é»æ•£æ­¥ï¼Œå¨œå¨œç­”æ‡‰äº†ã€‚ã€Œå¥½å•Šï¼Œæˆ‘å€‘å¯ä»¥å…ˆå»æ’çƒå ´ã€‚ã€ä½†çªç„¶ä¸€é¡†æ’çƒé£›ä¾†ï¼Œå¨œå¨œé€²è¡Œä½æ‰‹ç™¼çƒçš„æ™‚å€™ï¼Œçƒä¸å°å¿ƒæ‰“åˆ°äº†ä½ çš„è‡‰ã€‚ 
                <br><strong>çµå±€ï¼š</strong>ä½ è¢«çƒæ“Šä¸­ï¼Œè‡‰éƒ¨å—å‚·ï¼Œå¨œå¨œå°æ­¤æ„Ÿåˆ°å¾ˆæŠ±æ­‰ï¼Œé€™æ¬¡æ•£æ­¥ä»¥å¤±æ•—å‘Šçµ‚ã€‚`,
                "options": {},
                "image": "./img/scene10.jpg"
            },
            {
                "scene": "å‚³è¨Šæ¯å•å¨œå¨œ",
                "text": `ä½ å‚³è¨Šæ¯å•å¨œå¨œã€Œè¦ç¾åœ¨å—ã€ï¼Œå¥¹å›è¦†èªªï¼šã€Œå¥½å•Šï¼Œæˆ‘ç¾åœ¨æ­£å¥½æœ‰ç©ºã€‚ã€ 
                <br><strong>é¸æ“‡ï¼š</strong>
                <br>A. å»ä¸­å¤§æ¹–é‚Šæ•£æ­¥ã€‚
                <br>B. å»ç¹æ ¡åœ’ã€‚
                <br>C. å»å®µå¤œè¡—å’Œå¾Œé–€ã€‚
                <br>D. è·Ÿå¨œå¨œèŠåˆ°æ­·å²ã€‚`,
                "options": {
                    "A": 11,
                    "B": 12,
                    "C": 13,
                    "D": 17
                },
                "image": "./img/scene11.jpg"
            },
            {
                "scene": "ä¸­å¤§æ¹–é‚Šæ•£æ­¥",
                "text": `ä½ å€‘ä¾†åˆ°ä¸­å¤§æ¹–é‚Šï¼Œå¾®é¢¨è¼•æ‹‚ï¼Œå¨œå¨œçš„æƒ…ç·’ä¼¼ä¹é€æ¼¸ç·©å’Œã€‚
                <br><br><strong>å¨œå¨œï¼š</strong>ã€Œé€™è£¡çœŸå®‰éœï¼Œæˆ‘çš„å¿ƒæƒ…å¥½åƒå¥½äº†ä¸€é»ã€‚ã€ã€Œæˆ‘å€‘å»ç”²æ¿å§ï¼ã€ 
                <br><strong>é¸æ“‡ï¼š</strong>
                <br>A. æè­°åä¸‹ä¾†èŠèŠã€‚
                <br>B. å•å¥¹ç‚ºä»€éº¼ç”Ÿæ°£ã€‚
                <br>C. èªªä½ ä¸€ç›´éƒ½åœ¨ä¹å¥¹çš„æ„Ÿå—ã€‚`,
                "options": {
                    "A": 14,
                    "B": 15,
                    "C": 16
                },
                "image": "./img/scene12.jpg"
            },
            {
                "scene": "å»ç¹æ ¡åœ’",
                "text": `ä½ å€‘ç¹è‘—æ ¡åœ’ï¼Œå¥½å¹¾åœˆï¼Œå¥½å¹¾åœˆï¼Œå¥½å¹¾åœˆã€‚å¨œå¨œçš„å¿ƒæƒ…ä¼¼ä¹ç¨æœ‰ç·©å’Œã€‚
                <br><br><strong>å¨œå¨œï¼š</strong>ã€ŒçœŸçš„å¥½å–œæ­¡èµ°èµ°ã€‚ã€ã€Œä¸‹æ¬¡ä¸€èµ·èµ°åˆ°è‡ºåŒ—ã€
                <br><strong>é¸æ“‡ï¼š</strong>
                <br>A. æè­°åä¸‹ä¾†èŠèŠã€‚
                <br>B. å•å¥¹ç‚ºä»€éº¼ç”Ÿæ°£ã€‚
                <br>C. èªªä½ ä¸€ç›´éƒ½åœ¨ä¹å¥¹çš„æ„Ÿå—ã€‚`,
                "options": {
                    "A": 14,
                    "B": 15,
                    "C": 16
                },
                "image": "./img/scene13.jpg"
            },
            {
                "scene": "å»å®µå¤œè¡—å’Œå¾Œé–€",
                "text": `ä½ å€‘ä¾†åˆ°å®µå¤œè¡—å’Œå¾Œé–€ï¼Œå‘¨åœéƒ½æ˜¯é£Ÿç‰©çš„å‘³é“ï¼Œå¨œå¨œçš„å¿ƒæƒ…ä¼¼ä¹é€æ¼¸å¹³éœã€‚
                <br><br><strong>å¨œå¨œï¼š</strong>ã€Œæœ‰é£Ÿç‰©çš„åœ°æ–¹ï¼ŒçœŸçš„æ˜¯æˆ‘æœ€å–œæ­¡çš„åœ°æ–¹ã€‚ã€ 
                <br><strong>é¸æ“‡ï¼š</strong>
                <br>A. æè­°åä¸‹ä¾†èŠèŠã€‚
                <br>B. å•å¥¹ç‚ºä»€éº¼ç”Ÿæ°£ã€‚
                <br>C. èªªä½ ä¸€ç›´éƒ½åœ¨ä¹å¥¹çš„æ„Ÿå—ã€‚`,
                "options": {
                    "A": 14,
                    "B": 15,
                    "C": 16
                },
                "image": "./img/scene14.jpg"
            },
            {
                "scene": "èŠå¤©",
                "text": `ä½ å€‘èŠèŠï¼Œå¨œå¨œçµ‚æ–¼æŠŠå¿ƒä¸­çš„ç…©æƒ±å‘Šè¨´äº†ä½ ï¼Œã€Œæˆ‘åªæ˜¯è¦ºå¾—ä½ èª¤æœƒæˆ‘äº†ã€‚ã€
                ã€Œæˆ‘åªæ˜¯å¾ˆèªçœŸåœ¨å¯«æˆ‘çš„ç¨‹å¼ä½œæ¥­ï¼Œä¸æ˜¯ä¸ç†ä½ ã€‚ã€ ã€Œé€™å€‹ä½œæ¥­æˆ‘å¾æ™šä¸Šå…­é»å¯«åˆ°éš”å¤©å…«é»ã€

                <br><strong>çµå±€ï¼š</strong>ä½ è€å¿ƒè½å¥¹èªªã€‚ä½ èªªã€Œå¥½ï¼Œé‚£æˆ‘å€‘ç­‰ä¸€ä¸‹åƒæ­ªå¥½çµ²ã€ã€‚
                è®“å¨œå¨œæ„Ÿè¦ºå¥½å¤šäº†ï¼Œä½ å€‘çš„é—œä¿‚å¾—åˆ°äº†ä¿®å¾©ã€‚
                å¨œå¨œå¾ˆé–‹å¿ƒåœ°èªªï¼šã€ŒçœŸçš„å¥½é–‹å¿ƒå–”ï¼Œé¨é¨ï¼Œä½ çœŸçš„å¾ˆæ‡‚æˆ‘ï¼ã€ï¼Œå¨œå¨œæ±ºå®šä¹–ä¹–åœ°è¦åŠƒä¸‹ä¸€æ¬¡çš„æ—…è¡Œã€‚ä½ æˆåŠŸäº†ã€‚`,
                "options": {},
                "image": "./img/scene15.jpg"
            },
            {
                "scene": "å•ç”Ÿæ°£åŸå› ",
                "text": `ä½ å•å¥¹ç‚ºä»€éº¼ç”Ÿæ°£ï¼Œå¨œå¨œå‘Šè¨´äº†ä½ ä¸€äº›äº‹æƒ…ï¼Œã€Œæˆ‘è¦ºå¾—ä½ å¿½è¦–äº†æˆ‘ã€‚ã€ã€Œæˆ‘æ²’æœ‰ä¸å›ä½ è¨Šæ¯ï¼Œæˆ‘åªæ˜¯å¯«ä½œæ¥­åˆ°å¤©äº®æ²’ç¡è¦ºã€
                ã€Œæˆ‘æ²’æœ‰å›å®¶å°±å¿˜è¨˜ä½ ï¼Œæ˜¯æˆ‘çœŸçš„å¾ˆä¸æœƒå¯«ç¨‹å¼ï¼Œå¯«å¥½ä¹…ã€‚ã€

                <br><strong>çµå±€ï¼š</strong>ä½ è€å¿ƒè½å¥¹èªªè®“å¨œå¨œæ„Ÿè¦ºå¥½å¤šäº†ã€‚
                ä½ èªªã€Œå¥½ï¼Œé‚£æˆ‘å€‘å»è²·è¿·å®¢å¤å§æ³•èŠ™å¨œå¯å¯ç„¡ç³–ã€ã€‚ä½ å€‘çš„é—œä¿‚å¾—åˆ°äº†ä¿®å¾©ã€‚
                å¨œå¨œå¾ˆé–‹å¿ƒåœ°èªªï¼šã€ŒçœŸçš„å¥½é–‹å¿ƒå–”ï¼Œé¨é¨ï¼Œä½ çœŸçš„å¾ˆæ‡‚æˆ‘ï¼ã€ï¼Œå¨œå¨œæ±ºå®šä¹–ä¹–åœ°è¦åŠƒä¸‹ä¸€æ¬¡çš„æ—…è¡Œã€‚ä½ æˆåŠŸäº†ã€‚`,
                "options": {},
                "image": "./img/scene16.jpg"
            },
            {
                "scene": "è¡¨é”é—œå¿ƒ",
                "text": `ä½ å‘Šè¨´å¥¹ä½ ä¸€ç›´éƒ½å¾ˆåœ¨ä¹å¥¹çš„æ„Ÿå—ï¼Œå¨œå¨œæ„Ÿå‹•åœ°çœ‹è‘—ä½ ï¼Œã€Œè¬è¬ä½ åœ¨ä¹æˆ‘ã€‚ã€
                 ã€Œæˆ‘åªæ˜¯ç¡è‘—çš„æ™‚å€™ä½ é†’è‘—ï¼Œä½ é†’è‘—çš„æ™‚å€™æˆ‘ç¡è‘—ã€‚ã€ã€Œæˆ‘æ²’æœ‰ä¸è®€ä½ è¨Šæ¯ã€

                <br><strong>çµå±€ï¼š</strong>ä½ å€‘åœ¨åº¦éäº†ä¸€å€‹æ„‰å¿«çš„æ™‚å…‰ï¼Œå¨œå¨œçš„å¿ƒæƒ…é€æ¼¸æ¢å¾©ã€‚
                ã€Œè¦ä¸è¦å»åƒå†°æ·‡æ·‹ã€å¨œå¨œå¾ˆé–‹å¿ƒåœ°èªªï¼šã€ŒçœŸçš„å¥½é–‹å¿ƒå–”ï¼Œé¨é¨ï¼Œä½ çœŸçš„å¾ˆæ‡‚æˆ‘ï¼ã€ï¼Œå¨œå¨œæ±ºå®šä¹–ä¹–åœ°è¦åŠƒä¸‹ä¸€æ¬¡çš„æ—…è¡Œã€‚ä½ æˆåŠŸäº†`,
                "options": {},
                "image": "./img/scene17.jpg"
            },
            {
                "scene": "èŠåˆ°æ­·å²",
                "text": `ä½ è·Ÿå¨œå¨œèŠåˆ°æ­·å²ï¼Œå¨œå¨œé¡¯å¾—å¾ˆæœ‰èˆˆè¶£ã€‚ 
                <br><strong>é¸æ“‡ï¼š</strong>
                <br>A. è¡¨ç¾èˆˆå¥®ï¼Œè·Ÿå¨œå¨œæš¢èŠã€‚ 
                <br>B. æ‰“å“ˆæ¬ ï¼Œå¨œå¨œå¾ˆé›£éï¼Œä¸¦é–‹å§‹ç™¼å‡ºã€Œå‘€å‘€å‘€å‘€ã€çš„è²éŸ³ã€‚ 
                <br>C. è½‰ç§»æ³¨æ„åŠ›ï¼Œè§¸ç™¼å¦ä¸€å€‹äº‹ä»¶ã€‚`,
                "options": {
                    "A": 18,
                    "B": 19,
                    "C": 20
                },
                "image": "./img/scene18.jpg"
            },
            {
                "scene": "æ•…å®®æè­°å¤±æ•—",
                "text": `å› ç‚ºèŠæ­·å²å¾ˆé–‹å¿ƒï¼Œå¨œå¨œæè­°å»åƒè§€æ•…å®®ï¼Œä½†é¨é¨å¯¦éš›ä¸Šå°æ­¤ä¸æ„Ÿèˆˆè¶£ï¼Œè¡¨ç¤ºå¤±æ•—ã€‚`,
                "options": {},
                "image": "./img/scene19.jpg"
            },
            {
                "scene": "å‘€å‘€å‘€å¤±æ•—å¤±æ•—ğŸ‘©ğŸ»",
                "text": `å¨œå¨œé–‹å§‹ç™¼å‡ºã€Œå‘€å‘€å‘€å‘€ã€çš„è²éŸ³ï¼Œè®“é¨é¨æ„Ÿåˆ°éå¸¸å°·å°¬ï¼Œçªç„¶å¨œå¨œç™¼å‡ºå…‰ï¼Œè®Šæˆäº†é¨é¨çš„åª½åª½ï¼Œé€™ä½¿å¾—é¨é¨ç„¡æ³•å¿å—ï¼Œè¡¨ç¤ºå¤±æ•—ã€‚`,
                "options": {},
                "image": "./img/scene20.jpg"
            },
            {
                "scene": "è½‰ç§»æ³¨æ„åŠ›",
                "text": `ä½ è©¦åœ–è½‰ç§»å¨œå¨œçš„æ³¨æ„åŠ›ã€‚ 
                <br><strong>é¸æ“‡ï¼š</strong>
                <br>A. å•å¨œå¨œæœ‰æ²’æœ‰è½éä¼½åˆ©ç•¥ã€‚ 
                <br>B. å•å¨œå¨œæœ‰æ²’æœ‰è½éå³ä¸‰æ¡‚ã€‚ 
                <br>C. å•å¨œå¨œæœ‰æ²’æœ‰è½éé”æ–‡è¥¿ã€‚`,
                "options": {
                    "A": 21,
                    "B": 22,
                    "C": 23
                },
                "image": "./img/scene21.jpg"
            },
            {
                "scene": "ä¼½åˆ©ç•¥å¤±æ•—å¤±æ•—ğŸ§”ğŸ»â€â™‚ï¸",
                "text": `ä½ å•å¨œå¨œæœ‰æ²’æœ‰è½éä¼½åˆ©ç•¥ï¼Œå¨œå¨œçªç„¶åƒé™„èº«ä¸€æ¨£ï¼Œä¸åœåœ°å¤§å–Šã€Œå…‰æ˜æœƒï¼å…‰æ˜æœƒï¼å…‰æ˜æœƒï¼ã€ï¼Œä½ ä¸çŸ¥é“å¦‚ä½•æ‡‰å°ï¼Œè¡¨ç¤ºå¤±æ•—ã€‚`,
                "options": {},
                "image": "./img/scene22.jpg"
            },
            {
                "scene": "å³ä¸‰æ¡‚å¤±æ•—",
                "text": `ä½ å•å¨œå¨œæœ‰æ²’æœ‰è½éå³ä¸‰æ¡‚ï¼Œå¨œå¨œçªç„¶æ€’é«®è¡å† ï¼Œè‡‰è‰²è®Šå¾—éå¸¸ç”Ÿæ°£ã€Œå¥½å“‡ï¼ ï¼ å°±åœ“åœ“ã€ï¼Œæœ€çµ‚å¥¹æ°£å¾—è½‰èº«é›¢é–‹ï¼Œè¡¨ç¤ºå¤±æ•—ã€‚`,
                "options": {},
                "image": "./img/scene23.jpg"
            },
            {
                "scene": "é”æ–‡è¥¿å¤±æ•—",
                "text": `ä½ å•å¨œå¨œæœ‰æ²’æœ‰è½éé”æ–‡è¥¿ï¼Œå¨œå¨œè®Šå¾—éå¸¸é–‹å¿ƒï¼Œæè­°ä¸€èµ·å»çœ‹é”æ–‡è¥¿çš„å±•è¦½ï¼Œä½†ä½ å°æ­¤å…¶å¯¦ä¸¦ä¸æ„Ÿèˆˆè¶£ï¼Œè¡¨ç¤ºå¤±æ•—ã€‚`,
                "options": {},
                "image": "./img/scene24.jpg"
            }
        ];

        document.getElementById('messageForm').addEventListener('submit', function (event) {
            event.preventDefault();
            var inputElement = document.getElementById('messageInput');
            var message = inputElement.value.trim().toUpperCase();

            addToConversationHistory('user', message);
            displayMessage(message, 'user');
            inputElement.disabled = true;

            setTimeout(() => {
                inputElement.disabled = false;
                handleSceneChange(message);
            }, 500);

            document.getElementById('messageInput').value = '';
        });

        document.getElementById('introButton').addEventListener('click', function () {
            document.getElementById('introBlock').style.display = 'block';
            this.style.display = 'none';
            document.getElementById('startButton').style.display = 'block';
        });

        document.getElementById('startButton').addEventListener('click', function () {
            document.getElementById('introBlock').style.display = 'none';
            document.getElementById('inputBlock').style.display = 'block';
        });

        document.getElementById('userInfoForm').addEventListener('submit', function (event) {
            event.preventDefault();
            playerName = document.getElementById('playerName').value.trim();
            apiKey = document.getElementById('apiKey').value.trim();

            if (playerName && apiKey) {
                console.log(`ç©å®¶åå­—ï¼š${playerName}`);
                console.log(`API Keyï¼š${apiKey}`);

                document.getElementById('inputBlock').style.display = 'none';
                document.getElementById('backgroundWrapper').style.backgroundImage = `url('${scenes[0].image}')`;
                document.getElementById('gameContainer').style.display = 'inline';
                document.getElementById('introButton').style.display = 'none';
                document.getElementById('quickButton').style.display = 'inline';
                document.getElementById('restartButton').style.display = 'inline';

                displayScene();
            } else {
                alert("è«‹è¼¸å…¥ä½ çš„åå­—å’Œ API Keyï¼");
            }
        });

        document.getElementById('quickButton').addEventListener('click', function () {
            quickDisplay = !quickDisplay;
            this.innerText = quickDisplay ? 'é—œé–‰å¿«æ·é¡¯ç¤º' : 'å¿«æ·é¡¯ç¤ºå°è©±';
        });

        document.getElementById('restartButton').addEventListener('click', function () {
            currentScene = 0;
            conversationHistory = [];
            document.getElementById('messages').innerHTML = '';
            document.getElementById('backgroundWrapper').style.backgroundImage = `url('${scenes[0].image}')`;
            displayScene();
        });

        function addToConversationHistory(role, text) {
            conversationHistory.push({
                "role": role,
                "parts": [{
                    "text": text
                }]
            });
        }

        function displayMessage(message, sender) {
            var messageElement = document.createElement('div');
            var formatMessage = formatText(message);
            messageElement.classList.add('message');
            if (sender === 'user') {
                messageElement.classList.add('userMessage');
            } else {
                messageElement.classList.add('botMessage');
            }
            document.getElementById('messages').appendChild(messageElement);

            function typeText(element, text, index) {
                if (quickDisplay) {
                    element.innerHTML = text;
                    document.getElementById('messages').scrollTop = document.getElementById('messages').scrollHeight;
                } else {
                    if (index < text.length) {
                        let char = text[index];
                        if (char === '<') {
                            let endIndex = text.indexOf('>', index);
                            if (endIndex !== -1) {
                                element.innerHTML += text.substring(index, endIndex + 1);
                                index = endIndex + 1;
                            }
                        } else {
                            element.innerHTML += char;
                            index++;
                        }
                        setTimeout(function () {
                            typeText(element, text, index);
                        }, 75);
                    } else {
                        document.getElementById('messages').scrollTop = document.getElementById('messages').scrollHeight;
                    }
                }
            }

            typeText(messageElement, formatMessage, 0);
        }

        function handleSceneChange(option) {
            var currentOptions = scenes[currentScene].options;
            if (currentOptions[option] !== undefined) {
                currentScene = currentOptions[option];
                displayScene();
                document.getElementById('backgroundWrapper').style.backgroundImage = `url('${scenes[currentScene].image}')`;
            } else {
                displayMessage("ç„¡æ•ˆçš„é¸é …ï¼Œè«‹è¼¸å…¥æœ‰æ•ˆçš„é¸é …ï¼ˆä¾‹å¦‚ï¼šAï¼ŒBï¼ŒCï¼‰ã€‚", 'bot');
            }
        }

        function displayScene() {
            var scene = scenes[currentScene];
            var sceneText = `<br><strong>å ´æ™¯ï¼š${scene.scene}</strong><br>${scene.text}`;
            displayMessage(sceneText, 'bot');
        }

        function formatText(text) {
            let formattedText = text.replace(/\*\*(.*?)\*\*/g, '<br><strong>$1</strong>');
            formattedText = text.replace(/\*(.*?)\s/g, '<br>$1');
            return formattedText;
        }
    </script>
</body>

</html>
